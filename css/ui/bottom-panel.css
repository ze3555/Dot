/* ================================
   DOT — Bottom Panel (ChatGPT‑style)
   File: css/ui/bottom-panel.css
   ================================= */

/* Корневая нижняя панель — максимально тонкая,
   без лишней высоты, с safe‑area и бэкдропом. */
.bottom-panel {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 40;

  /* лёгкий фон поверх контента */
  backdrop-filter: saturate(180%) blur(12px);
  -webkit-backdrop-filter: saturate(180%) blur(12px);
  background: color-mix(in oklab, var(--dot-surface, #0b0b0b) 70%, transparent);

  /* тонкая вертикальная упаковка без принудительной высоты */
  padding: 10px 12px calc(10px + env(safe-area-inset-bottom));
  border-top: 1px solid color-mix(in oklab, #fff 7%, transparent);
}

/* Центровщик, чтобы панель была узкой как у ChatGPT */
.bottom-panel__inner {
  max-width: 720px;            /* ширина "капсулы" как у ChatGPT */
  margin: 0 auto;
}

/* Форма композитора */
#chat-form {
  display: flex;
  align-items: flex-end;
  gap: 8px;

  /* чтобы не растягивалась по высоте панель */
  min-height: 0;
}

/* Левая круглая кнопка «плюс» (необязательная) */
.chat-plus-btn {
  flex: 0 0 auto;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  display: inline-grid;
  place-items: center;
  border: 1px solid color-mix(in oklab, #fff 14%, transparent);
  background: color-mix(in oklab, var(--dot-surface, #111) 92%, #000 8%);
  color: color-mix(in oklab, #fff 85%, transparent);
  cursor: pointer;
  user-select: none;
  transition: transform .12s ease, border-color .12s ease, background .12s ease;
}
.chat-plus-btn:active { transform: scale(.96); }
.chat-plus-btn:hover { border-color: color-mix(in oklab, #fff 28%, transparent); }

/* Капсульный input — как у ChatGPT */
#chat-input {
  flex: 1 1 auto;
  max-height: 160px;           /* авто‑рост, но без «гармошки» */
  min-height: 44px;
  line-height: 22px;
  padding: 10px 14px;
  border-radius: 9999px;
  outline: none;

  border: 1px solid color-mix(in oklab, #fff 14%, transparent);
  background: color-mix(in oklab, var(--dot-surface, #121212) 92%, #000 8%);
  color: var(--dot-fg, #e9e9e9);

  resize: none;                /* как у ChatGPT */
  width: 100%;

  /* визуально — тонко, но читаемо */
  box-shadow:
    0 0 0 1px color-mix(in oklab, #000 60%, transparent) inset;
  transition: border-color .12s ease, box-shadow .12s ease, background .12s ease;
}

#chat-input::placeholder {
  color: color-mix(in oklab, #fff 50%, transparent);
  opacity: .7;
}

#chat-input:focus {
  border-color: color-mix(in oklab, #4da3ff 40%, #fff 15%);
  box-shadow:
    0 0 0 1px color-mix(in oklab, #4da3ff 32%, transparent) inset,
    0 0 0 3px color-mix(in oklab, #4da3ff 18%, transparent);
}

/* Правая кнопка «Send» — круглая, как у ChatGPT */
.chat-send-btn {
  flex: 0 0 auto;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  display: inline-grid;
  place-items: center;
  cursor: pointer;
  user-select: none;

  border: 1px solid color-mix(in oklab, #fff 14%, transparent);
  background: color-mix(in oklab, #fff 8%, var(--dot-surface, #111) 92%);
  color: color-mix(in oklab, #fff 85%, transparent);

  transition: transform .12s ease, opacity .12s ease, border-color .12s ease, background .12s ease;
}
.chat-send-btn:hover { border-color: color-mix(in oklab, #fff 28%, transparent); }
.chat-send-btn:active { transform: scale(.96); }

/* Состояние «готово к отправке» — делаем кнопку ярче */
body.dot-send-ready .chat-send-btn {
  opacity: 1;
  background: color-mix(in oklab, #4da3ff 28%, var(--dot-surface, #111) 72%);
  border-color: color-mix(in oklab, #4da3ff 40%, #fff 15%);
  color: #fff;
}

/* В dock‑режиме (Дот как кнопка отправки) — прячем запасную send,
   и оставляем место справа под «докнутый» Дот */
body.dot-dock .chat-send-btn { display: none; }
body.dot-dock #chat-form { padding-right: 48px; } /* запас под док‑Дота */

/* Когда нет Дота вовсе — убедимся, что кнопка видна */
body.no-dot-core .chat-send-btn { display: inline-grid; }

/* Планшеты: немного шире капсула */
@media (min-width: 768px) {
  .bottom-panel__inner { max-width: 820px; }
}

/* Светлая тема — аккуратные оттенки */
body.theme-light .bottom-panel {
  background: color-mix(in oklab, #fff 85%, transparent);
  border-top-color: color-mix(in oklab, #000 10%, transparent);
}
body.theme-light #chat-input {
  background: #fff;
  color: #111;
  border-color: color-mix(in oklab, #000 12%, transparent);
  box-shadow: 0 0 0 1px color-mix(in oklab, #000 7%, transparent) inset;
}
body.theme-light #chat-input:focus {
  border-color: color-mix(in oklab, #4da3ff 40%, #000 10%);
  box-shadow:
    0 0 0 1px color-mix(in oklab, #4da3ff 35%, transparent) inset,
    0 0 0 3px color-mix(in oklab, #4da3ff 18%, transparent);
}
body.theme-light .chat-plus-btn,
body.theme-light .chat-send-btn {
  background: color-mix(in oklab, #000 3%, #fff 97%);
  border-color: color-mix(in oklab, #000 12%, transparent);
  color: #111;
}
body.theme-light .chat-send-btn:hover,
body.theme-light .chat-plus-btn:hover {
  border-color: color-mix(in oklab, #000 22%, transparent);
}

/* Скрываем пережитки широкой панели, если где-то остались */
.bottom-panel,
#chat-form,
#chat-input { box-sizing: border-box; }
#chat-input {
  font-size: 16px; /* убираем zoom на iOS при фокусе */
  -webkit-text-size-adjust: 100%; /* фиксирует размер шрифта */
}